(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{30:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),c=n(18),i=n.n(c),r=n(7),s=(n(30),n(17)),l=n(3),u=n(2),d=n(0);function m(e){var t=a.a.useState(""),n=Object(l.a)(t,2),o=n[0],c=n[1],i=a.a.useState(""),r=Object(l.a)(i,2),s=r[0],u=r[1];return Object(d.jsxs)(S,{onSubmit:function(t){t.preventDefault(),e.onUpdateCard({name:o,link:s}),u(""),c("")},isOpen:e.isOpen,onClose:e.onClose,name:"add",formname:"formAdd",title:"New Place",children:[Object(d.jsx)("input",{id:"title-input",minLength:"2",maxLength:"30",name:"name",type:"text",className:"form__input form__input_type_title",placeholder:"Title",required:!0,value:o,onChange:function(e){c(e.target.value)}}),Object(d.jsx)("span",{className:"form__input-error",id:"title-input-error"}),Object(d.jsx)("input",{id:"url-input",type:"url",name:"link",className:"form__input form__input_type_url",placeholder:"Image URL",required:!0,onChange:function(e){u(e.target.value)},value:s}),Object(d.jsx)("span",{className:"form__input-error",id:"url-input-error"})]})}var j=a.a.createContext();var p=function(e){var t,n,o=a.a.useContext(j),c=e.card.owner===o._id,i="card__delete-btn ".concat(c?"card_show-delete-btn card_show-delete-btn":"card__delete-btn"),r=null===(t=e.card.likes)||void 0===t?void 0:t.some((function(e){return e._id===o.id})),s="card__heart ".concat(r?" card__heart_active":"card__heart");return Object(d.jsxs)("li",{className:"card ",children:[Object(d.jsx)("img",{src:e.card.link,className:"card__pic",onClick:function(){e.onCardClick(e.card)},alt:e.card.name}),Object(d.jsx)("button",{"aria-label":"Delete Button",onClick:function(){e.onCardDelete(e.card)},className:i}),Object(d.jsxs)("div",{className:"card__text",children:[Object(d.jsx)("h2",{className:"card__title",children:e.card.name}),Object(d.jsxs)("div",{className:"card__likes_container",children:[Object(d.jsx)("button",{"aria-label":"Like Button",onClick:function(){e.onCardLike(e.card)},className:"".concat(s)}),Object(d.jsx)("p",{className:"card__likes_count",children:null===(n=e.card.likes)||void 0===n?void 0:n.length})]})]})]})};function _(e){var t=a.a.useState(""),n=Object(l.a)(t,2),o=n[0],c=n[1],i=a.a.useState(""),r=Object(l.a)(i,2),s=r[0],u=r[1];var m=a.a.useContext(j);return a.a.useEffect((function(){c(m.name||""),u(m.about||"")}),[m]),Object(d.jsxs)(S,{onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:s})},isOpen:e.isOpen,onClose:e.onClose,name:"edit",formname:"formEdit",title:"Edit Profile",children:[Object(d.jsx)("input",{id:"name-input",minLength:"2",maxLength:"40",name:"name",type:"text",className:"form__input form__input_type_name",placeholder:"Name",required:!0,value:o,onChange:function(e){c(e.target.value)}}),Object(d.jsx)("span",{className:"form__input-error",id:"name-input-error"}),Object(d.jsx)("input",{id:"job-input",minLength:"2",maxLength:"200",type:"text",name:"about",className:"form__input form__input_type_job",placeholder:"About Me",required:!0,value:s,onChange:function(e){u(e.target.value)}}),Object(d.jsx)("span",{className:"form__input-error",id:"job-input-error"})]})}function b(e){var t=a.a.useRef();return Object(d.jsxs)(S,{name:"avatar",formname:"formAvatar",title:"Avatar",onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value}),t.current.value=""},isOpen:e.isOpen,onClose:e.onClose,children:[Object(d.jsx)("input",{id:"avatar-input",type:"url",name:"avatar",className:"form__input form__input_type_url form__input_type_avatar",placeholder:"Image URL",required:!0,ref:t}),Object(d.jsx)("span",{className:"form__input-error",id:"avatar-input-error"})]})}var f=n(19),h=n(20),g=n(23),O=n(22),x=function(e){Object(g.a)(n,e);var t=Object(O.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(d.jsx)("footer",{className:"footer",children:Object(d.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around The U.S."})})}}]),n}(a.a.Component);function v(e){return Object(d.jsx)("header",{className:"header",children:Object(d.jsxs)("div",{className:"header__container ".concat(e.headerlogout),children:[Object(d.jsx)("div",{className:"header__logo","aria-label":"text logo that says Around'"}),e.children]})})}function N(e){var t=e.onCardClick,n=e.onAddPlace,o=e.onEditProfile,c=e.onEditAvatar,i=e.cards,s=e.onCardLike,l=e.onCardDelete,u=e.onSignOut,m=a.a.useContext(j);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(v,{headerlogout:"header__container_log-out",children:Object(d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(d.jsx)("p",{children:m.email}),Object(d.jsx)(r.b,{style:{textDecoration:"none",color:"#A9A9A9",paddingLeft:24},onClick:u,to:"/login",children:"Log Out"})]})}),Object(d.jsxs)("main",{className:"container",children:[Object(d.jsx)("section",{className:"profile",children:Object(d.jsxs)("div",{className:"profile__container",children:[Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsx)("div",{className:"profile__avatar-btn",onClick:c,children:Object(d.jsx)("img",{src:m.avatar,className:"profile__pic",alt:"avatar"})}),Object(d.jsxs)("div",{className:"profile__text",children:[Object(d.jsx)("h1",{className:"profile__name",children:m.name}),Object(d.jsx)("button",{type:"button","aria-label":"Profile Edit Button",className:"form_button profile__edit-btn",onClick:o}),Object(d.jsx)("p",{className:"profile__job",children:m.about})]})]}),Object(d.jsx)("button",{type:"button","aria-label":"Card Add Button",id:"addButton",className:"form_button profile__add-btn",onClick:n})]})}),Object(d.jsx)("section",{className:"cards",children:Object(d.jsx)("ul",{className:"cards__list",children:i.map((function(e){return Object(d.jsx)(p,{onCardLike:s,onCardDelete:l,onCardClick:t,card:e},e._id)}))})})]})]})}function S(e){return Object(d.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),children:Object(d.jsxs)("div",{className:"modal__container",children:[Object(d.jsxs)("form",{onSubmit:e.onSubmit,action:"#",className:"form form_".concat(e.formname),name:e.name,noValidate:!0,children:[Object(d.jsx)("h2",{className:"form__title",children:e.title}),e.children,Object(d.jsx)("button",{type:"submit",className:"form__button ".concat(e.name,"-submit"),children:"Save"})]}),Object(d.jsx)("button",{"aria-label":"Close Button",type:"reset",className:"modal__close-button modal__close-button_".concat(e.name),onClick:e.onClose})]})})}function C(e){return Object(d.jsx)("div",{className:"modal modal_type_pic ".concat(e.isOpen?"modal_open":""),children:Object(d.jsxs)("div",{className:"modal__container",children:[Object(d.jsx)("button",{"aria-label":"Close Button ",type:"button",className:"modal__close-button modal__close-button_pic",onClick:e.onClose}),Object(d.jsxs)("figure",{className:"modal__figure",children:[Object(d.jsx)("img",{src:e.figimage,className:"modal__img",alt:e.figcaption}),Object(d.jsx)("figcaption",{className:"modal__caption",children:e.figcaption})]})]})})}var y=n(24),k=n(25),A=function(e){var t=e.component,n=Object(k.a)(e,["component"]);return Object(d.jsx)(u.b,{children:function(){return n.loggedIn?Object(d.jsx)(t,Object(y.a)({},n)):Object(d.jsx)(u.a,{to:"/register"})}})};function w(e){if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}var L="http://localhost:3000";function E(e){var t=e.onSetEmail,n=e.onSetPassword,o=e.onRegister,a=e.message,c=e.email,i=e.password;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(v,{headerlogout:"header__container_log-out",children:Object(d.jsx)("div",{style:{display:"flex",alignItems:"center"},children:Object(d.jsx)(r.b,{style:{textDecoration:"none",color:"white",paddingLeft:24},to:"/login",children:"Log In"})})}),Object(d.jsx)("div",{className:"sign-in__container",children:Object(d.jsx)("div",{className:"modal__container",children:Object(d.jsxs)("form",{onSubmit:o,action:"#",className:"form form_sign_up }",name:"register",noValidate:!0,children:[Object(d.jsx)("h2",{className:"form__title form__title_sign_up",children:"Sign Up"}),Object(d.jsx)("span",{style:{color:"red"},children:a}),Object(d.jsx)("input",{id:"email-input",minLength:"2",maxLength:"40",name:"email",type:"text",className:"form__input form__input_sign_up form__input_type_email",placeholder:"Email",required:!0,value:c,onChange:t}),Object(d.jsx)("input",{id:"password-input",minLength:"2",maxLength:"200",name:"password",type:"password",className:"form__input form__input_sign_up form__input_type_password",placeholder:"Password",required:!0,value:i,onChange:n}),Object(d.jsx)("button",{type:"submit",className:"form__button form__button_sign_up register-submit ",children:"Sign up"}),Object(d.jsx)(r.b,{style:{textDecoration:"none",margin:20,textAlign:"center"},to:"/login",type:"submit",className:"form__button form__button_member_log_in form__button_sign_up ",children:"Already a member? Log in here!"})]})})})]})}function I(e){e.message;var t=e.email,n=e.onSetEmail,o=e.password,a=e.onSetPassword,c=e.onLogin;e.onInfoToolTip;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(v,{headerlogout:"header__container_log-out",children:Object(d.jsx)("div",{style:{display:"flex",alignItems:"center"},children:Object(d.jsx)(r.b,{style:{textDecoration:"none",color:"white",paddingLeft:24},to:"/register",children:"Sign Up"})})}),Object(d.jsx)("div",{className:"sign-in__container",children:Object(d.jsx)("div",{className:"modal__container",children:Object(d.jsxs)("form",{onSubmit:c,action:"#",className:"form form_sign_up\n           }",name:"login",noValidate:!0,children:[Object(d.jsx)("h2",{className:"form__title form__title_sign_up",children:"Log In"}),Object(d.jsx)("input",{value:t,onChange:n,id:"email-input",minLength:"2",maxLength:"200",type:"text",name:"email",className:"form__input form__input_sign_up form__input_type_email",placeholder:"Email",required:!0}),Object(d.jsx)("input",{value:o,onChange:a,id:"password-input",minLength:"2",maxLength:"200",type:"password",name:"password",className:"form__input form__input_sign_up form__input_type_job",placeholder:"Password",required:!0,typeof:"password"}),Object(d.jsx)("button",{type:"submit",className:"form__button form__button_sign_up ",children:"Log in"}),Object(d.jsx)(r.b,{style:{textDecoration:"none",margin:20,textAlign:"center"},to:"/register",type:"submit",className:"form__button form__button_member_log_in form__button_sign_up ",children:"Not a member yet? Sign up here!"})]})})})]})}var T="http://localhost:3000";var P=function(e){return Object(d.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),children:Object(d.jsxs)("div",{className:"modal__container",children:[Object(d.jsxs)("div",{className:"infotooltip__container",children:[Object(d.jsx)("div",{className:e.isItSuccess?"info-tool-tip-success":"info-tool-tip-failure"}),Object(d.jsx)("h1",{className:"infotooltip__message",children:e.isItSuccess?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]}),Object(d.jsx)("button",{"aria-label":"Close Button",type:"reset",className:"modal__close-button modal__close-button_".concat(e.name),onClick:e.onClose})]})})};var D=function(){var e=Object(u.g)(),t=Object(o.useState)([]),n=Object(l.a)(t,2),a=n[0],c=n[1],i=Object(o.useState)(!1),r=Object(l.a)(i,2),p=r[0],f=r[1],h=Object(o.useState)(!1),g=Object(l.a)(h,2),O=g[0],v=g[1],y=Object(o.useState)(!1),k=Object(l.a)(y,2),D=k[0],F=k[1],U=Object(o.useState)(!1),B=Object(l.a)(U,2),J=B[0],H=B[1],q=Object(o.useState)(!1),K=Object(l.a)(q,2),z=K[0],R=K[1],V=Object(o.useState)(!1),M=Object(l.a)(V,2),G=M[0],Y=M[1],Q=Object(o.useState)({}),W=Object(l.a)(Q,2),X=W[0],Z=W[1],$=Object(o.useState)(!1),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],oe=Object(o.useState)(""),ae=Object(l.a)(oe,2),ce=ae[0],ie=ae[1],re=Object(o.useState)(""),se=Object(l.a)(re,2),le=se[0],ue=se[1],de=Object(o.useState)(""),me=Object(l.a)(de,2),je=me[0],pe=me[1],_e=Object(o.useState)(!1),be=Object(l.a)(_e,2),fe=be[0],he=be[1],ge=Object(o.useState)(!1),Oe=Object(l.a)(ge,2),xe=Oe[0],ve=Oe[1];function Ne(){ie(""),ue(""),pe("")}function Se(e){ue(e.target.value)}function Ce(e){ie(e.target.value)}function ye(){he(!0)}function ke(){v(!1),F(!1),H(!1),Y(!1),f(!1),R(!1),he(!1)}return Object(o.useEffect)((function(){var t=localStorage.getItem("token");t&&(console.log("token",t),console.log("has token",t),function(e){var t=localStorage.getItem("token");return console.log("get content token ",t),fetch(T+"/users/me",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)})).then((function(e){return e}))}(t).then((function(e){if(e)return Z(e);pe("400 - one or more of the fields were not provided")})).then(ne(!0)).then((function(){e.push("/main")})).catch((function(e){console.log(e.message)})),fetch(L+"/cards",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return w(e)})).then((function(e){c(e)})).catch((function(e){console.log(e.message)})))}),[e,te]),Object(o.useEffect)((function(){localStorage.getItem("token")&&e.push("/login")}),[e]),Object(d.jsx)("div",{className:"page",children:Object(d.jsxs)(j.Provider,{value:X,children:[Object(d.jsxs)(u.d,{children:[Object(d.jsx)(A,{path:"/main",loggedIn:te,cards:a,component:N,onEditProfile:function(){F(!0)},onAddPlace:function(){v(!0)},onEditAvatar:function(){H(!0)},onDeleteCard:function(){Y(!0)},onCardClick:function(e){f(e),R(!0)},onCardDelete:function(e){var t;(t=e._id,fetch(L+"/cards/"+t,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},method:"DELETE"}).then((function(e){return w(e)}))).then((function(){var t=Object(s.a)(a).filter((function(t){return t._id!==e._id}));c(t)})).catch((function(e){console.log(e.message)}))},onCardLike:function(e){var t,n=null===(t=e.likes)||void 0===t?void 0:t.some((function(e){return e._id===X.id}));(function(e,t){var n;return n=t?"PUT":"DELETE",fetch(L+"/cards/likes/"+e,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},method:n}).then((function(e){return w(e)}))})(e._id,!n).then((function(t){console.log("newCASFUHIAUFHISAUDHFIASFHUKSDFKSAJDFKASJFHKASJDHFKSDJHFAKSDHJFKASJDHFLKASJFHSAard",t);var n=a.map((function(n){return n._id===e._id?t:n}));c(n)})).catch((function(e){console.log(e.message)}))},onSignOut:function(){localStorage.removeItem("token"),e.push("/login"),ne(!1)}}),Object(d.jsx)(u.b,{path:"/register",children:Object(d.jsx)(E,{message:je,onSetEmail:Ce,onSetPassword:Se,onRegister:function(t){t.preventDefault(),le&&ce&&function(e,t){return fetch(T+"/users/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)})).then((function(e){return e}))}(ce,le).then((function(e){if(!e||400===e.status)throw pe("400 - one of the fields was filled in incorrectly"),ve(!1),ye(),e.status(400).json({message:"one or more of the fields were not provided"}),new Error("Error!!");return ve(!0),ye(),e})).then(Ne).then(e.push("/login")).catch((function(e){console.log(e.message)}))}})}),Object(d.jsx)(u.b,{path:"/login",children:Object(d.jsx)(I,{onSetEmail:Ce,message:je,onSetPassword:Se,onLogin:function(t){t.preventDefault(),ce&&le?function(e,t){return fetch(T+"/users/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).then((function(e){if(e.token)return localStorage.setItem("token",e.token),e}))}(ce,le).then((function(e){if(!e)throw ve(!1),ye(),pe("401 - the user with the specified email not found"),e.status(401).json({message:"the user with the specified email not found"}),new Error("email doesn't exist");e&&ne(!0)})).then(Ne).then((function(){e.push("/login")})).catch((function(e){console.log(e.message)})):pe("400 - one or more of the fields were not provided")},onInfoToolTip:ye})}),Object(d.jsx)(u.b,{exact:!0,path:"/",children:te?Object(d.jsx)(u.a,{to:"/main"}):Object(d.jsx)(u.a,{to:"/login"})})]}),Object(d.jsx)(x,{}),Object(d.jsx)(_,{isOpen:D,onClose:ke,onUpdateUser:function(e){(function(e){var t=e.name,n=e.about;return fetch(L+"/users/me",{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({name:t,about:n})}).then((function(e){return w(e)}))})({name:e.name,about:e.about}).then((function(e){return Z(e)})).then(ke).catch((function(e){console.log(e.message)}))}}),Object(d.jsx)(b,{isOpen:J,onClose:ke,onUpdateAvatar:function(e){(function(e){var t=e.avatar;return fetch(L+"/users/me/avatar",{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({avatar:t})}).then((function(e){return w(e)}))})({avatar:e.avatar}).then((function(e){return Z(e)})).then(ke).catch((function(e){console.log(e.message)}))}}),Object(d.jsx)(m,{isOpen:O,onClose:ke,onUpdateCard:function(e){(function(e){var t=e.name,n=e.link;return fetch(L+"/cards",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},method:"POST",body:JSON.stringify({name:t,link:n})}).then((function(e){return w(e)}))})(e).then((function(e){return c([e].concat(Object(s.a)(a)))})).then(ke).catch((function(e){console.log(e.message)}))}}),Object(d.jsx)(S,{isOpen:G,onClose:ke,name:"delete",title:"Are you sure?"}),Object(d.jsx)(C,{isOpen:z,onClose:ke,figimage:p.link,figcaption:p.name}),Object(d.jsx)(P,{isOpen:fe,isItSuccess:xe,onClose:ke})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),o(e),a(e),c(e),i(e)}))};i.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(r.a,{children:Object(d.jsx)(D,{})})}),document.getElementById("root")),F()}},[[40,1,2]]]);
//# sourceMappingURL=main.21d3c42b.chunk.js.map